<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Hello World</title>
</head>

<script src="pixi.js"></script>

<body>
<script type="text/javascript">
    let type = "WebGL";
    if(!PIXI.utils.isWebGLSupported()){
        type = "canvas";
    }

    PIXI.utils.sayHello(type);

    let Application = PIXI.Application,
        loader = PIXI.loader,
        resources = PIXI.loader.resources,
        Sprite = PIXI.Sprite,
        Graphics = PIXI.Graphics,
        Text = PIXI.Text,
        TextStyle = PIXI.TextStyle;

    let app = new Application({
        width: 1024,
        height: 600, // 768
        antialias: true,
        transparent: false,
        resolution: 1
    });

    document.body.appendChild(app.view);
     app.renderer.backgroundColor = 0x99999999;

    loader
        .add("images/quarter-note.png")
        .load(setup);

    let state, quarter, startButton, introText, introTextStyle, outroText;

    function setup () {
        quarter = new Sprite(resources['images/quarter-note.png'].texture);
        quarter.anchor.set(0.5);
        quarter.x = 80;
        quarter.y = 80;
        quarter.vx = 0;
        quarter.vy = 0;
        quarter.width = 30;
        quarter.height = 50;
    
        app.stage.addChild(quarter);

        introTextStyle = new TextStyle({
            fontFamily: 'Arial',
            fontSize: 36,
            fill: 'white',
            stroke: '#ff3300',
            strokeThickness: 4,
            dropShadow: true,
            dropShadowColor: '#000000',
            dropShadowBlur: 4,
            dropShadowAngle: Math.PI / 6,
            dropShadowDistance: 6
        });

        introText = new Text('Beat It', introTextStyle);
        introText.x = 20;
        introText.y = 3;
        app.stage.addChild(introText);

        outroText = new Text("Great job, mighty RhythMathTist!");
        outroText.x = 300;
        outroText.y = 30;
        app.stage.addChild(outroText);
        outroText.visible = false;

        startButton = new Graphics();
        startButton.lineStyle(4, 0xFF3300, 1);
        startButton.beginFill(0x66CCFF);
        startButton.drawRect(0, 0, 64, 64);
        startButton.endFill();
        startButton.x = 500;
        startButton.y = app.screen.width / 3 * 2;
        app.stage.addChild(startButton);

        startButton.interactive = true;
        startButton.buttonMode = true;
        startButton.visible = false;
        startButton.on('click',  () => state = math);

        state = intro;

        app.ticker.add(delta => gameLoop(delta));

    }

    function gameLoop (delta) {
        state(delta);
    }

    function intro (delta) {
        startButton.visible = true;
    }

    function math (delta) {
        introText.visible = false;
        startButton.visible = false;
        console.log('hi');

        // Calculate current math problem

        // Display prompt, draggable notes, drop zone
    }

    function music (delta) {

        // Place animated music player person

        // Place scrolling music display

        // Place start button

        // When start button is pressed, begin music play

        // User taps screen in time with selected notes, accuracy is counted

    }

    function outro (delta) {
        outroText.visible = true;
    }


</script>
</body>
</html>
